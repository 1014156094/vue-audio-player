import{_ as E,o as l,c as d,a as r,n as h,w as y,t as p,b as k,d as C,T,e as P,f as S,r as w,F as L,g as B,h as v,v as _,m as M,i as V}from"./index-515a66ad.js";window._iconfont_svg_string_1017934='<svg><symbol id="icon-volume-no" viewBox="0 0 1024 1024"><path d="M625.2544 162.7648v710.144c0 56.7296-70.0416 84.224-109.312 42.9568l-182.4256-166.5536H110.6944c-45.9776 0-83.2-37.2736-83.2-83.2V388.4544c0-44.032 34.3552-80.4864 78.2848-83.0976l5.5808-0.1536 224.9216 3.7376 179.6608-189.1328c39.2704-41.3184 109.3632-13.7728 109.312 42.9568z"  ></path></symbol><symbol id="icon-play-next" viewBox="0 0 1024 1024"><path d="M279.5646875 980.080625L743.06 598.6475 743.06 919.5640625a38.5096875 38.5096875 0 1 0 77.47875 0.916875l0-816.5034375a38.5096875 38.5096875 0 1 0-77.47875 0L743.06 427.64375l-463.4953125-383.7253125a45.845625 45.845625 0 0 0-76.1034375 33.92625L203.46125 946.154375a45.845625 45.845625 0 0 0 76.1034375 33.92625z"  ></path></symbol><symbol id="icon-play-prev" viewBox="0 0 1024 1024"><path d="M744.4353125 43.919375L280.94 425.3525 280.94 104.4359375a38.5096875 38.5096875 0 1 0-77.47875-0.916875l0 816.5034375a38.5096875 38.5096875 0 1 0 77.47875 0L280.94 596.35625l463.4953125 383.7253125a45.845625 45.845625 0 0 0 76.1034375-33.92625L820.53875 77.845625a45.845625 45.845625 0 0 0-76.1034375-33.92625z"  ></path></symbol><symbol id="icon-pause" viewBox="0 0 1024 1024"><path d="M512 1012.62222187C234.38222187 1012.62222187 11.37777813 789.61777813 11.37777813 512S234.38222187 11.37777813 512 11.37777813s500.62222187 223.0044448 500.62222187 500.62222187-223.0044448 500.62222187-500.62222187 500.62222187z m136.53333333-682.66666667c-27.30666667 0-45.51111147 18.2044448-45.51111146 45.51111147v273.06666666c0 27.30666667 18.2044448 45.51111147 45.51111146 45.51111147s45.51111147-18.2044448 45.51111147-45.51111147V375.46666667c0-27.30666667-18.2044448-45.51111147-45.51111147-45.51111147zM375.46666667 329.9555552c-27.30666667 0-45.51111147 18.2044448-45.51111147 45.51111147v273.06666666c0 27.30666667 18.2044448 45.51111147 45.51111147 45.51111147s45.51111147-18.2044448 45.51111146-45.51111147V375.46666667c0-27.30666667-18.2044448-45.51111147-45.51111146-45.51111147z"  ></path></symbol><symbol id="icon-volume" viewBox="0 0 1024 1024"><path d="M1009.6852389 501.04265842v72.84551793c-12.28886699 137.14708366-93.42867683 254.45999047-208.60559588 317.12488904L762.68733667 817.14116381A318.92799715 318.92799715 0 0 0 928.10158763 537.46541682a319.0112165 319.0112165 0 0 0-175.15102891-284.80766635l38.33682717-73.87190158c120.33657856 61.22241365 205.74836509 181.25385159 218.39785301 322.25680953z m-165.69165255 27.96202667a248.96745017 248.96745017 0 0 1-120.17013874 213.51559395l-38.55874617-74.0660827a165.77487189 165.77487189 0 0 0 75.50856761-139.44951125 165.77487189 165.77487189 0 0 0-78.03291762-141.08617842l38.44778667-74.01060238a248.96745017 248.96745017 0 0 1 122.80544825 215.0967808zM625.26285255 162.75206827V872.89877618c0 56.72851683-70.04376747 84.24670094-109.29601764 42.94168462l-182.44667619-166.55159523H110.71162937a83.2203173 83.2203173 0 0 1-83.2203173-83.2203173V388.44556857a83.2203173 83.2203173 0 0 1 78.31031808-83.0816165l5.60350208-0.1387008 224.9167781 3.74491478 179.67266474-189.13204224c39.22451001-41.33275762 109.2960165-13.78683221 109.29601764 42.94168348z"  ></path></symbol><symbol id="icon-play" viewBox="0 0 1024 1024"><path d="M512 8.97941504c277.81531056 0 503.02058496 225.20527562 503.02058496 503.02058496s-225.20527562 503.02058496-503.02058496 503.02058496S8.97941504 789.81531056 8.97941504 512 234.18468944 8.97941504 512 8.97941504z m-70.12698734 325.48390806c-26.63050141 0-48.23079685 21.60029545-48.23079807 48.23079686v253.81827015a48.23079685 48.23079685 0 0 0 74.26951062 40.56712988l199.46245688-128.1518906a48.23079685 48.23079685 0 0 0-0.35507283-81.37097702l-199.46245689-125.66637833a48.23079685 48.23079685 0 0 0-25.71322921-7.42695094z"  ></path></symbol></svg>',function(e){var s=(s=document.getElementsByTagName("script"))[s.length-1],t=s.getAttribute("data-injectcss"),s=s.getAttribute("data-disable-injectsvg");if(!s){var u,i,a,c,m,g=function(f,n){n.parentNode.insertBefore(f,n)};if(t&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(f){console&&console.log(f)}}u=function(){var f,n=document.createElement("div");n.innerHTML=e._iconfont_svg_string_1017934,(n=n.getElementsByTagName("svg")[0])&&(n.setAttribute("aria-hidden","true"),n.style.position="absolute",n.style.width=0,n.style.height=0,n.style.overflow="hidden",n=n,(f=document.body).firstChild?g(n,f.firstChild):f.appendChild(n))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(u,0):(i=function(){document.removeEventListener("DOMContentLoaded",i,!1),u()},document.addEventListener("DOMContentLoaded",i,!1)):document.attachEvent&&(a=u,c=e.document,m=!1,b(),c.onreadystatechange=function(){c.readyState=="complete"&&(c.onreadystatechange=null,o())})}function o(){m||(m=!0,a())}function b(){try{c.documentElement.doScroll("left")}catch{return void setTimeout(b,50)}o()}}(window);const I={name:"AudioPlayer",inheritAttrs:!1,props:{audioList:{require:!0,default:()=>[],type:Array},showPlayButton:{default:!0,type:Boolean},showPrevButton:{default:!0,type:Boolean},showNextButton:{default:!0,type:Boolean},showVolumeButton:{default:!0,type:Boolean},showProgressBar:{default:!0,type:Boolean},beforePlay:{default:null,type:Function},beforePrev:{default:null,type:Function},beforeNext:{default:null,type:Function},isLoop:{type:Boolean,default:!0},isAutoPlayNext:{type:Boolean,default:!0},progressInterval:{default:1e3,type:Number},showPlaybackRate:{type:Boolean,default:!0},showPlayLoading:{type:Boolean,default:!0},playbackRates:{type:Array,default:()=>[.5,1,1.5,2]},themeColor:{type:String,default:"#EC4141"},disabledProgressDrag:{type:Boolean,default:!1},disabledProgressClick:{type:Boolean,default:!1}},emits:["pause","play-prev","play-next","timeupdate","loadedmetadata","ended","progress-start","progress-end","progress-move","progress-click","playing","play","play-error"],data(){return{isIOS:/iPhone|iPad|iPod/i.test(window.navigator.userAgent),isPlaying:!1,isDragging:!1,isDraggingVolume:!1,isShowErrorMessage:!1,isLoading:!1,isShowVolume:!1,isShowRates:!1,timer:null,noticeMessage:"",duration:"",currentPlayIndex:0,currentTime:"",currentVolume:1,playbackRate:1,canProgressDrag:!0}},computed:{currentTimeFormatted(){return this.currentTime?this.formatTime(this.currentTime):"00:00"},durationFormatted(){return this.duration?this.formatTime(this.duration):"00:00"}},mounted(){this.$nextTick(()=>{this.$refs.audioProgressPoint.addEventListener("mousedown",this.handleProgressPanstart),document.addEventListener("mousemove",this.handleProgressPanmove),document.addEventListener("mouseup",this.handleProgressPanend),this.$refs.playVolumeWrap.addEventListener("touchmove",this.handleVolumePanmove),this.$refs.audioProgressPoint.addEventListener("touchstart",this.handleProgressPanstart),document.addEventListener("touchmove",this.handleProgressPanmove),document.addEventListener("touchend",this.handleProgressPanend)})},beforeUnmount(){this.pause(),this.$refs.audioProgressPoint.removeEventListener("mousedown",this.handleProgressPanstart),document.removeEventListener("mousemove",this.handleProgressPanmove),document.removeEventListener("mouseup",this.handleProgressPanend),this.$refs.playVolumeWrap.removeEventListener("mousemove",this.handleVolumePanmove),this.$refs.audioProgressPoint.removeEventListener("touchstart",this.handleProgressPanstart),document.removeEventListener("touchmove",this.handleProgressPanmove),document.removeEventListener("touchend",this.handleProgressPanend)},methods:{updateMediaMetadata(){"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:this.audioList[this.currentPlayIndex].title,artist:this.audioList[this.currentPlayIndex].artist,album:this.audioList[this.currentPlayIndex].album,artwork:this.audioList[this.currentPlayIndex].artwork}),navigator.mediaSession.setActionHandler("play",()=>{this.play()}),navigator.mediaSession.setActionHandler("pause",()=>{this.pause()}),navigator.mediaSession.setActionHandler("previoustrack",()=>{this.playPrev()}),navigator.mediaSession.setActionHandler("nexttrack",()=>{this.playNext()}))},handleVolumeIconTouchstart(){this.isShowVolume=!this.isShowVolume},handleVolumePanmove(e){let t=this.$refs.playVolumeWrap.getBoundingClientRect(),s=e.pageY||e.touches[0].pageY,u,i;u=Math.round(t.bottom-s),i=u/this.$refs.playVolumeWrap.offsetHeight,i=Math.min(i,1),i=Math.max(i,0),this.$refs.audio.volume=i,this.currentVolume=i},handleSetPlaybackRate(e){this.playbackRate=+e,this.$refs.audio.playbackRate=+e,this.isShowRates=!1},handleShowErrorMessage(e={}){this.noticeMessage=e.message,this.isShowErrorMessage=!0,window.setTimeout(()=>{this.isShowErrorMessage=!1},e.duration||3e3)},onLoadedmetadata(e){this.duration=this.$refs.audio.duration,this.$emit("loadedmetadata",e)},onTimeUpdate(e){this.$emit("timeupdate",e)},formatTime(e){let t;return t=Math.floor(e/60),e=Math.ceil(e%60),t+="",e+="",t=t.length===1?"0"+t:t,e=e.length===1?"0"+e:e,t+":"+e},onEnded(e){window.setTimeout(()=>{this.pause(),this.$emit("ended",e),this.isLoop&&this.isAutoPlayNext&&this.playNext()},1e3)},handleProgressPanstart(e){this.canProgressDrag=!1,!this.disabledProgressDrag&&(this.isDragging=!0,this.$emit("progress-start",e))},handleProgressPanend(e){console.log("handleProgressPanend"),!(this.disabledProgressDrag||!this.isDragging)&&(this.$refs.audio.currentTime=this.currentTime,this.play(),this.isDragging=!1,this.$emit("progress-end",e))},handleProgressPanmove(e){if(this.disabledProgressDrag||!this.isDragging)return;let t=e.pageX||e.touches[0].pageX,s=this.$refs.audioProgressPoint.getBoundingClientRect(),i=parseInt(getComputedStyle(this.$refs.audioProgressPoint).left)+(t-s.left);i=Math.min(i,this.$refs.audioProgressWrap.offsetWidth),i=Math.max(i,0),this.setPointPosition(i),this.$refs.audioProgress.style.width=i+"px",this.currentTime=i/this.$refs.audioProgressWrap.offsetWidth*this.duration,this.$emit("progress-move",e)},handleClickProgressWrap(e){if(this.disabledProgressClick||!this.canProgressDrag){this.canProgressDrag=!0;return}let t=e.target,s=e.pageX||e.touches[0].pageX,u=t.getBoundingClientRect(),a=parseInt(getComputedStyle(t).left)+(s-u.left);t!==this.$refs.audioProgressPoint&&(this.currentTime=a/this.$refs.audioProgressWrap.offsetWidth*this.duration,this.$refs.audio.currentTime=this.currentTime,this.setPointPosition(a),this.$refs.audioProgress.style.width=a+"px",this.canProgressDrag=!0,this.play(),this.$emit("progress-click",e))},setPointPosition(e){this.$refs.audioProgressPoint.style.left=e-this.$refs.audioProgressPoint.offsetWidth/2+"px"},playing(){if(this.isDragging)return;let e=this.$refs.audio.currentTime/this.$refs.audio.duration*this.$refs.audioProgressWrap.offsetWidth;this.currentTime=this.$refs.audio.currentTime,this.$refs.audioProgress.style.width=e+"px",this.setPointPosition(e),this.$emit("playing")},play(){this.isLoading=!0;let e=()=>{this.$refs.audio.play().then(()=>{this.$nextTick(()=>{this.timer?this.currentTime=this.$refs.audio.currentTime:this.timer=window.setInterval(this.playing,this.progressInterval),this.isPlaying=!0,this.isLoading=!1,this.$refs.audio.playbackRate=this.playbackRate}),this.$emit("play")}).catch(t=>{this.handleShowErrorMessage({message:t.message}),t.code===9&&this.isAutoPlayNext&&window.setTimeout(()=>{this.playNext()},3e3),this.isLoading=!1,this.$emit("play-error",t)}),this.updateMediaMetadata()};if(this.isIOS&&(console.log("为了解决 iOS 设备接口异步请求后出现无法播放问题，请无视 The play() request was interrupted by a call to pause() 错误"),this.$refs.audio.play(),this.$refs.audio.pause()),this.beforePlay){this.beforePlay(t=>{t!==!1&&e()});return}e()},pause(){this.$refs.audio.pause(),this.$nextTick(()=>{this.clearTimer(),this.isPlaying=!1,this.$emit("pause")})},playPrev(){if(this.currentPlayIndex<=0&&!this.isLoop)return;this.clearTimer();let e=()=>{this.currentPlayIndex<=0&&this.isLoop?this.currentPlayIndex=this.audioList.length-1:this.currentPlayIndex--,this.$nextTick(()=>{this.play(),this.$emit("play-prev")})};if(this.beforePrev){this.beforePrev(t=>{t!==!1&&e()});return}e()},clearTimer(){window.clearInterval(this.timer),this.timer=null},playNext(){if(this.currentPlayIndex+1>=this.audioList.length&&!this.isLoop)return;this.clearTimer();let e=()=>{this.currentPlayIndex+1>=this.audioList.length&&this.isLoop?this.currentPlayIndex=0:this.currentPlayIndex++,this.$nextTick(()=>{this.play(),this.$emit("play-next")})};if(this.beforeNext){this.beforeNext(t=>{t!==!1&&e()});return}e()}}},N={class:"audio-player"},A={class:"audio__btn-wrap"},D=["onClick"],R=r("svg",{class:"audio__play-icon","aria-hidden":"true"},[r("use",{"xlink:href":"#icon-play-prev"})],-1),W={key:2,class:"audio__play-loading"},z=r("svg",{class:"audio__play-icon","aria-hidden":"true"},[r("use",{"xlink:href":"#icon-play"})],-1),F=r("svg",{class:"audio__play-icon","aria-hidden":"true"},[r("use",{"xlink:href":"#icon-pause"})],-1),H=r("svg",{class:"audio__play-icon","aria-hidden":"true"},[r("use",{"xlink:href":"#icon-play-next"})],-1),j={key:5,class:"audio__play-volume-icon-wrap"},O=["xlink:href"],X={class:"audio__time-wrap"},U={class:"audio__current-time"},Y={class:"audio__duration"},q=["src"];function $(e,t,s,u,i,a){var c,m,g;return l(),d("div",N,[r("div",A,[s.showPlaybackRate?(l(),d("div",{key:0,class:"audio__play-rate",style:h({color:s.themeColor})},[r("span",{onClick:t[0]||(t[0]=y(o=>i.isShowRates=!i.isShowRates,["stop"]))},p(i.playbackRate.toFixed(1)+"x"),1),k(T,{name:"fade-rate"},{default:C(()=>[v(r("div",{class:"audio__play-rate__dropdown",style:h({backgroundColor:s.themeColor})},[(l(!0),d(L,null,B(s.playbackRates,o=>(l(),d("div",{key:"pr_"+o,onClick:y(b=>a.handleSetPlaybackRate(o),["stop"])},p(o.toFixed(1)+"x"),9,D))),128))],4),[[_,i.isShowRates]])]),_:1})],4)):P("",!0),s.showPrevButton?(l(),d("div",{key:1,class:S(["audio__play-prev",{disable:!s.isLoop&&i.currentPlayIndex===0}]),onClick:t[1]||(t[1]=y((...o)=>a.playPrev&&a.playPrev(...o),["stop"])),style:h({color:s.themeColor})},[w(e.$slots,"play-prev",{},()=>[R])],6)):P("",!0),i.isLoading&&s.showPlayLoading?(l(),d("div",W,[(l(),d(L,null,B(8,o=>r("span",{key:o,style:h({backgroundColor:s.themeColor})},null,4)),64))])):(l(),d(L,{key:3},[!i.isPlaying&&s.showPlayButton?(l(),d("div",{key:0,class:"audio__play-start",onClick:t[2]||(t[2]=y((...o)=>a.play&&a.play(...o),["stop"])),style:h({color:s.themeColor})},[w(e.$slots,"play-start",{},()=>[z])],4)):s.showPlayButton?(l(),d("div",{key:1,class:"audio__play-pause",onClick:t[3]||(t[3]=y((...o)=>a.pause&&a.pause(...o),["stop"])),style:h({color:s.themeColor})},[w(e.$slots,"play-pause",{},()=>[F])],4)):P("",!0)],64)),s.showNextButton?(l(),d("div",{key:4,class:S(["audio__play-next",{disable:!s.isLoop&&i.currentPlayIndex===s.audioList.length-1}]),onClick:t[4]||(t[4]=y((...o)=>a.playNext&&a.playNext(...o),["stop"])),style:h({color:s.themeColor})},[w(e.$slots,"play-next",{},()=>[H])],6)):P("",!0),s.showVolumeButton?(l(),d("div",j,[(l(),d("svg",{class:"audio__play-icon","aria-hidden":"true",style:h({color:s.themeColor}),onClick:t[5]||(t[5]=y((...o)=>a.handleVolumeIconTouchstart&&a.handleVolumeIconTouchstart(...o),["stop"]))},[r("use",{"xlink:href":i.currentVolume?"#icon-volume":"#icon-volume-no"},null,8,O)],4)),k(T,{name:"fade-volume"},{default:C(()=>[v(r("div",{ref:"playVolumeWrap",class:"audio__play-volume-wrap",onClick:t[6]||(t[6]=y((...o)=>a.handleVolumePanmove&&a.handleVolumePanmove(...o),["stop"]))},[r("div",{ref:"playVolume",class:"audio__play-volume",style:h({height:i.currentVolume*100+"%",backgroundColor:s.themeColor})},null,4)],512),[[_,i.isShowVolume]])]),_:1})])):P("",!0),v(r("div",{class:"audio__notice"},p(i.noticeMessage),513),[[_,i.isShowErrorMessage]])]),v(r("div",{ref:"audioProgressWrap",class:"audio__progress-wrap",style:h({cursor:s.disabledProgressClick?"auto":"pointer"}),onClick:t[7]||(t[7]=y((...o)=>a.handleClickProgressWrap&&a.handleClickProgressWrap(...o),["stop"]))},[r("div",{ref:"audioProgress",class:"audio__progress",style:h({backgroundColor:s.themeColor})},null,4),r("div",{ref:"audioProgressPoint",class:"audio__progress-point",style:h({backgroundColor:s.themeColor,boxShadow:`0 0 10px 0 ${s.themeColor}`,cursor:s.disabledProgressDrag?"auto":"pointer"})},null,4)],4),[[_,s.showProgressBar]]),v(r("div",X,[r("div",U,p(a.currentTimeFormatted),1),r("div",Y,p(a.durationFormatted),1)],512),[[_,s.showProgressBar]]),r("audio",M({ref:"audio",class:"audio-player__audio",src:((c=s.audioList)==null?void 0:c[i.currentPlayIndex])||((g=(m=s.audioList)==null?void 0:m[i.currentPlayIndex])==null?void 0:g.src)},e.$attrs,{onEnded:t[8]||(t[8]=(...o)=>a.onEnded&&a.onEnded(...o)),onTimeupdate:t[9]||(t[9]=(...o)=>a.onTimeUpdate&&a.onTimeUpdate(...o)),onLoadedmetadata:t[10]||(t[10]=(...o)=>a.onLoadedmetadata&&a.onLoadedmetadata(...o))})," 浏览器太老咯，请升级浏览器吧~ ",16,q)])}const x=E(I,[["render",$]]);x.install=e=>{e.component(x.name,x)};const G={components:{AudioPlayer:x},data(){return{currentAudioName:"",audioList:[{src:"http://music.163.com/song/media/outer/url?id=317151.mp3",title:"Audio Title 1",artist:"Artist Name 1",album:"Album Name 1",artwork:[{src:"https://upload.jianshu.io/users/upload_avatars/1696356/c358e43854eb?imageMogr2/auto-orient/strip|imageView2/1/w/96/h/96/format/webp",sizes:"512x512",type:"image/jpg"}]},{src:"http://downsc.chinaz.net/Files/DownLoad/sound1/201906/11582.mp3",title:"Audio Title 2"}]}},methods:{handleBeforePlay(e){this.currentAudioName=this.audioList[this.$refs.audioPlayer.currentPlayIndex].title,e()},handlePlaySpecify(){this.$refs.audioPlayer.currentPlayIndex=1,this.$nextTick(()=>{this.$refs.audioPlayer.play(),this.title=this.audioList[this.$refs.audioPlayer.currentPlayIndex].name})},handleEnded(){console.log("ended")}}},J={class:"name"};function K(e,t,s,u,i,a){var m;const c=V("audio-player");return l(),d("div",null,[r("div",J,p(i.currentAudioName||i.audioList[0].title),1),k(c,{ref:"audioPlayer","audio-list":(m=i.audioList)==null?void 0:m.map(g=>g.src),"before-play":a.handleBeforePlay,"show-play-loading":!1,onEnded:a.handleEnded},null,8,["audio-list","before-play","onEnded"]),r("button",{onClick:t[0]||(t[0]=(...g)=>a.handlePlaySpecify&&a.handlePlaySpecify(...g))},"Play the second audio")])}const Z=E(G,[["render",K],["__scopeId","data-v-6193eafa"]]);export{Z as default};
